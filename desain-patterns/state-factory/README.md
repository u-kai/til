# State パターン

- 状態をクラスで表現する
- 状態をクラスとして表現していれば，クラスを切り替えることに良 p って状態の変化が表せるし，新しい状態を追加する場合は何をプログラムすればいいのかがわかる

# Factory パターンの紹介

- インスタンスの生成部分をクラスから切り離すもの

## Sample Code

- パブリックリポジトリ検知後のアラートロジック

- 要件
  - 一回目に検知されたパブリックレポジトリは利用者と管理者にアラートされ，検知された回数をインクリメントして 情報を DB に保存される
  - 二回目以降の場合かつ検知された回数が 20 で割り切れない場合はではアラートはされずに回数のインクリメントだけされて，情報を DB に保存される
  - 20 で割り切れた場合は利用者と管理者にきつめのアラートをして ，検知された回数をインクリメントして 情報を DB に保存させる
  - 定時時間後の検知は何もしない

## mediator みたく中央集権的にロジックを集中させるのは？

- 今回はオブジェクト同士で協調したやり取りがなされてない
- そのため，ロジックを分散させたとしても，他のオブジェクトの変更が他のオブジェクトの変更に影響しない
- 逆に今回のようなものを中央集権的に取り締まると，新しい State の追加や，State の振る舞いの変更が中央集権にも変更が及んでしまう
- ただし，今回のサンプルでは，action に関してはロジックが分散しているが，Actor の生成については中央集権的に行なっているため，Actor が増えると StateContext に変更が入る

## おまけ

- 要件追加を考える
  - 土日に初めての検知を行ったら厳しいアラートを送る
  - public な状態が許可されている時 public に変更がないのか確認して変更があれば変更ぶんを管理者に通知する
