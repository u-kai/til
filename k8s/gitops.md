# GitOps

- Git を用いた CI/CD の手法の一つ
- GitOps ではアプリケーションのアップデート，すなわち Deployment などのリソースが使用する Docker イメージの変更のような k8s クラスタの操作を Git リポジトリを介して行うこと

1. アプリケーションのソースコードを変更する
1. アプリケーションのテストを行う
1. コンテナイメージを作成する(アプリケーションのコンパイルを含む)
1. コンテナイメージをコンテナレジストリにプッシュする
1. Deployment などのマニフェストを書き変える(イメージのタグ)
1. kubectl apply 相当の処理を実行してクラスタに反映する

- GitOps ではアプリケーション用のリポジトリと， k8s マニフェスト管理用のリポジトリの 2 つの Git リポジトリが用意される
- 一連の流れで開発者が必要なことは，ソースコードの変更をソースコード用の Git リポジトリにコミットすること，マニフェスト変更分の Pull Request を確認してマージすることだけ
- インフラへの変更がすべて単一のリポジトリで完結するようになっていると，そのリポジトリの状態がクラスタの状態と等価になるため，そのリポジトリのコミットを Revert することで環境を元に戻すことが可能
