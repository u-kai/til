# CI/CD

## CI/CD とは

- CI/CD とは、Continuous Integration と Continuous Delivery の略で、継続的インテグレーションと継続的デリバリーのことを指す

## CI

- CI とは継続的にプログラムを統合すること

  - よく言われるのが 1 日一回以上本番のプロダクトコードに新規のコードを統合すること
  - 統合するポイントとしてデファクトスタンダードなのが Git リモートリポジトリ
  - 概念として，プラクティスや実行するものに対しても CI と言われることがある
    - コードを統合した後に，コンパイル,テストを行うことまでを CI という風に言うこともある
    - このような CI を行うサーバを CI サーバとも呼ぶ

- 自分の変更を push するだけではない
- 統合した後にシステムが壊れていないかを確認することが重要
  - 統合はシステムが壊れるいちばんのリスク
- そのため，CI では，プログラムのコンパイルから，テストまでシステムが正常であることを確認するような一連の仕組みが必要
- 一回の統合で上記のようなことを全て実行する必要がある
- この作業をいかに高速に，そして自動的に行うかが肝
- この作業を自動化することで，統合の頻度を上げることができる
- 自動化することで，繰り返し行うことのコストが激変する
- 統合の頻度を上げることで，統合のリスクを下げることができる

  - 小さな変更と大きな変更どっちがリスクがあるだろうか？

- Git のリモートリポジトリの多くのサービスでは，push されたことを検知して，CI を実行するような仕組みがあったり，コードが統合されたことを Event として他の CI サーバーに通知するような仕組みがあったりする
- これにより，開発者は自分のコードをリモートリポジトリに push するだけで，CI を実行することができ,システムを労力をかけずかつ安全に発展させることができる

## CD

- CD とは継続的にプログラムをデプロイしてデリバリー可能にすること
- デプロイとは，プログラムを実際に動かせる状態にすること
  - プログラムをコンパイルして，プログラムが稼働するサーバーなどに配置すること
  - つまり，サーバーなどのインフラストラクチャの準備も必要
- ほとんどが CI によって，プログラムの正確性を確認し，CD で必要なインフラストラクチャを準備して，プログラムをデプロイする
- デプロイすることで，ユーザーがシステムを利用できるようになる
- この行為を継続的にやることで，ユーザーにシステムを継続的にデリバリーすることができる
  - ユーザーから高速なフィードバックが得られる
  - ユーザーの要求を素早く反映することができる
  - 不具合が生じても，変更範囲がすくなければ素早く修正することができる

## CI/CD パイプライン

- CI と CD に必要な作業を一連の流れとして定義/実行できるもの
- CI/CD パイプラインを使うことで，CI/CD を自動かつ繰り返し実現することができる
- CI/CD パイプラインで処理が終了したらシステムとしてデプロイできる！と自信を持てるような構成にするべき
- 逆に言えば CI/CD パイプラインがしっかりしていれば自信を持ってシステムの変更ができる
- CI/CD パイプラインのようなものがなく，手動によるデプロイや，テストしかなければ，
  - 時間がかかる
  - 手動なので面倒
  - 手動なのでミスが起きやすい
  - 手動なので繰り返しすることが難しく，自然とシステムの変更頻度が下がる
  - システムの変更頻度が下がるといいことがない
  - デプロイするときに自信がなくなる
