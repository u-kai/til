# LLC 副層

- IEEE802.2 で規格化されており，メディアに依存することなく，同じ手順でデータ転送を行う機能を提供している
  - つまりメディアの違いを吸収して上位層から統一的に扱えるように LLC 副層が設けられている

## MAC 副層

- 上位層(LLC)で規定された手順に従い，物理媒体を制御してビット転送を行う機能を提供する
- MAC 副層の規定にはメディアアクセス制御である CSMA/CD などがある
- 物理層の規定には CSMA/CD で使用するケーブルの仕様などがある

## LLC/SNAP カプセル化

- LLC は IEEE802.2 で標準化され，データリンクサービスを上位層へ提供する機能を有する
- 3 つのタイプがありイーサネット(IEEE802.3)，無線 LAN(IEEE802.11)ではタイプ 1 が使用されている

  - コネクションレス型サービス
    - タイプ 1
    - 単純なベストエフォートのサービス
  - コネクション型サービス
    - タイプ 2
    - HDLC を基に規格化されたコネクション型のサービス
  - 確認応答コネクションレス型サービス
    - タイプ 3
    - コネクションレス型なのでコネクションの確立，再送制御，フロー制御を行わないが，確認応答をサポートするサービス

- LLC は SAP(Service Access Point)識別子を用いることで，ステーション内の DTE(Data Terminal Equipment データ端末装置)を識別する
- 宛先 SAP(Destination SAP)は宛先ステーションに複数の DTE がある場合の端末番号で，SSAP は送信元ステーションに複数の DTE がある場合の端末番号
- SAP 領域は長さが 1 バイトであるためより多くのサービスを特定できるように，SNAP(Sub-NetworkAccess Protocol)によるカプセル化が行われている
- RFC1042 では DIX 使用を除く IEEE802.3,IEEE802.4,IEEE802.5 で IP データグラムと ARP フレームを伝送する際 SNAP でカプセル化しなければいけないと規定している
- SNAP でカプセル化する場合，DSAP と SSAP は 0xAA に設定する
- このとき LLC 制御フィールドに続く 5 バイトが SNAP の二つのフィールドとして解釈される
- これらのデータは LLC ヘッダにある

## LLC ヘッダ

- 宛先 SAP(1)
  - SPT の BPDU は 0x42
  - IP データグラム，ARP フレームは 0xAA(SNAP カプセル化)
- 送信元 SAP(1)
- 制御(1)
  - BPDU，IP データグラム，ARP フレームは HDLC プロトコルの UI(Unnumbered Information)に相当するため 0x03
- データ(43~1497)
  - 以下が SNAP の役割を果たす
  - oui(3)
    - 後続のプロトコル識別子が属する組織を示す
    - IP データグラム，ARP フレームは 00-00-00
  - プロトコル識別子(2)
    - 上位層のプロトコルを示す
    - OUI が 00-00-00 の場合，DIX 仕様のタイプと同じ値が採用される
    - IP データグラムは 08-00，ARP フレームは 08-06
  - データ(38~1492)
