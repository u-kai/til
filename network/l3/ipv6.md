# IPv6

## 表記方法

- 16bit ごとに:で区切る
- 先頭の 0 は省略可能
- フィールド n ビットが全て 0 の場合，1 つの 0 に省略可能
- ビットが全て 0 のフィールドが連続している場合，その間の 0 を全て省略して::に省略可能
- ::は 1 つのアドレス内で一度しか使用できない

## プレフィックスとインターフェイス ID

- v4 のネットワーク部が v6 ではプレフィックス
- ホスト部がインターフェイス ID

## ユニキャスト通信

- リンクローカル
  - 同一セグメント
  - ルーティングされないため，ルータを超えることがない
- ユニークローカル
  - 組織内ネットワーク
  - IPv4 のプライベートアドレスに相当する
  - 異なるセグメント上の端末と通信できるが，組織内ネットワークでのみ有効なアドレス
- グローバル
  - グローバルネットワーク

## ICMPv6

- エラー通知機能やネットワーク情報収集機能だけでなく，ARP に相当する IPv6 アドレス解決機能，IPv6 アドレス重複検出機能，マルチキャスト機能が含まれている
- ICMPv6 メッセージはタイプ 0〜127 のエラーメッセージとタイプ 128〜255 の情報メッセージの大きく 2 つに分類される
- 近隣探索メッセージの ICMPv6 はマルチキャストアドレスを使用することで以下の機能を実現する

  - ルータ

    - IPv6 アドレスの自動設定
      - ノードに IPv6 アドレスを自動的に割り当てる機能
    - IPv6 プレフィックスの検出
      - 接続リンクのプレフィックスを検出して，直接通信可能なアドレス範囲を識別する機能
    - ネクストホップの決定
      - パケットのネクストホップを決定する機能
    - パラメータの検出
      - MTU などの値を検出する機能
    - ルータの検出
      - 同一インク上でノードが接続できるルータを検出する機能

  - Neighbor
    - データリンク層アドレスの解決
      - MAC アドレスと IPV6 アドレスを関連づける IPV4 の ARP に相当する機能
    - IPv6 アドレスの重複機能
      - ノードの I/F に設定した Ipv6 アドレスが他のノードと重複していないかを検出する機能
    - 近隣ノードの到達不能の検出
      - 近隣ノードの通信不能状態を検出する機能

## IPv6 Neighbor Discovery

- ARP に変わる機能
- 具体的には ICPMv6 の Neighbor Solicitation メッセージと妖精ノードマルチキャストにお y りアドレスを解決する機能

- IPv6 ではノードの I/F に IPv6 アドレスを設定した場合，その IPv6 アドレスのインターフェイス ID に対応する要請ノードマルチキャストアドレスのグループに自動的に参加する

-
