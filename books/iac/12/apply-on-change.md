Antipattern: Apply On Change Also known as: ad hoc automation. With the apply on change antipattern, configuration code is only applied to a server when there is a specific change to apply. For example, consider a team that runs multiple Tomcat application servers. The team members run an Ansible playbook to install and configure Tomcat when they create a new server instance, but once the server is running, they don’t run Ansible until they need to. When a new version of Tomcat is released, they update their playbook and apply it to their servers. In the most extreme version of this antipattern, you only apply code to the server that you specifically intend to change. The team in our example notices that one of its application servers is seeing much higher traffic, and the load is making Tomcat unstable. The team members make some changes to their playbook to optimize their Tomcat configuration for higher load and then apply it to the server that has the issue. But they don’t apply the playbook to the other application servers, because those don’t need the change. Motivation Systems and network administrators have traditionally managed servers by hand. When you need to make a change, you log in to the relevant server and make the change. Why would you do it differently? Even people who use scripts tend to write and run the scripts to make a specific change. The apply on change antipattern is an extension of this way of working that happens to use an Infrastructure as Code tool instead of a manual command or on-off script. Applicability Applying code only as needed for a specific change may be fine for a single temporary
server. But it’s not a suitable method for sustainably managing a group of servers.
アンチパターン：変更時に適用
別名：特定の変更に適用するアドホックな自動化
"apply on change"アンチパターンでは、構成コードは特定の変更があるときにのみサーバーに適用されます。たとえば、複数のTomcatアプリケーションサーバーを実行するチームを考えてみましょう。チームメンバーは、新しいサーバーインスタンスを作成する際にAnsibleのplaybookを実行してTomcatをインストールおよび設定しますが、サーバーが稼働している場合、必要に応じてAnsibleを実行しません。新しいバージョンのTomcatがリリースされると、彼らはplaybookを更新し、サーバーに適用します。このアンチパターンの最も極端なバージョンでは、特定の変更を意図的に適用するサーバーにのみコードを適用します。私たちの例のチームは、そのアプリケーションサーバーのうちの1つが非常に高いトラフィックを受けており、負荷がTomcatを不安定にしていることに気付きます。チームメンバーは、Tomcatの設定を高負荷に最適化するためにplaybookにいくつかの変更を加え、問題のあるサーバーに適用します。ただし、変更は必要ないため、他のアプリケーションサーバーにはplaybookを適用しません。動機 システム管理者やネットワーク管理者は伝統的にサーバーを手動で管理してきました。変更を加える必要がある場合、該当するサーバーにログインして変更を行います。なぜ異なる方法を選ぶのでしょうか？スクリプトを使用している人々でも、特定の変更を行うためにスクリプトを作成して実行する傾向があります。"apply on change"アンチパターンは、マニュアルコマンドやオンオフスクリプトの代わりにInfrastructure as Codeツールを使用した作業方法の拡張です。適用範囲 特定の変更に必要なコードのみを適用することは、単一の一時的なサーバーに対しては問題ありません。しかし、サーバーグループを持続可能に管理するための適切な方法ではありません。