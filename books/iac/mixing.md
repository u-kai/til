Mixing Declarative and Imperative Code Imperative code is a set of instructions that specifies how to make a thing happen. Declarative code specifies what you want, without specifying how to make it happen.3 Too much infrastructure code in production today suffers from mixing declarative and imperative code. I believe it’s an error to insist that one or the other of these two language paradigms should be used for all infrastructure code. An infrastructure codebase involves many different concerns, from defining infrastructure resources, to configuring different instances of otherwise similar resources, to orchestrating the provisioning of multiple interdependent pieces of a system. Some of these concerns can be expressed most simply using a declarative language. Some concerns are more complex, and are better handled with an imperative language. As practitioners of the still-young field of infrastructure code, we are still exploring where to draw boundaries between these concerns. Mixing concerns can lead to code that mixes language paradigms. One failure mode is extending a declarative syntax like YAML to add conditionals and loops. The second failure mode is embedding simple configuration data (“2GB RAM”) into procedural code, mixing what you want with how to implement it. In relevant parts of this book I point out where I believe some of the different concerns may be, and where I think one or another language paradigm may be most appropriate. But our field is still evolving. Much of my advice will be wrong or incomplete. So, my intention is to encourage you, the reader, to think about these questions and help us all to discover what works best.
宣言型と命令型のコードの混合
命令型のコードは、何を起こすかを指定する一連の命令です。宣言型のコードは、何を望んでいるかを指定し、実現方法は指定しません。現在のプロダクション環境の多くのインフラストラクチャコードは、宣言的なコードと命令的なコードを混在させています。私は、これらの2つの言語パラダイムのいずれかがすべてのインフラストラクチャコードに使用されるべきだと主張することはエラーだと考えています。インフラストラクチャのコードベースには、インフラストラクチャリソースの定義から、同様のリソースの異なるインスタンスの設定、システムの複数の相互依存するパーツのプロビジョニングのオーケストレーションまで、さまざまな懸念事項が関わっています。これらのうちのいくつかは、宣言的な言語を使用することで最もシンプルに表現できます。他の懸念事項はより複雑であり、命令的な言語で処理する方が適しています。インフラストラクチャコードのまだ若いフィールドの実践者として、これらの懸念事項の境界をどこに引くかをまだ探索中です。懸念事項を混在させると、言語パラダイムを混在させるコードになる可能性があります。1つの失敗モードは、条件文やループを追加するためにYAMLのような宣言的な構文を拡張することです。2番目の失敗モードは、手続き型のコードに単純な設定データ（"2GBのRAM"など）を埋め込み、望みと実装方法を混在させることです。本書の関連する部分では、異なる懸念事項がどこにあるか、またどの言語パラダイムが最も適切かを私が示しています。しかし、私たちの分野はまだ進化中です。私のアドバイスの多くは間違っているか不完全なものです。したがって、私の意図は、読者の皆さんにこれらの問いについて考え、最適な方法を一緒に見つける手助けをすることです。