# 6 業務データの分解

## データ分解要因

-   どのような場合にデータの分解を検討すべきか？という問いに対する答えと根拠を提供する
-   データ分解の 6 つの主な推進要因
    -   変更制御
        -   データベースのテーブルを変更することで影響を受けるサービスはいくつあるのか
    -   コネクション管理
        -   データベースは複数の分散サービスからの必要なコネクションを処理できるのか
    -   スケーラビリティ
        -   アクセスしてくるサービスの要求に応じてデータベースをスケールできるのか
    -   耐障害性
        -   データベースのクラッシュやメンテナンスによるダウンタイムの影響を受けるサービスはどのくらいあるのか
    -   アーキテクチャ量子
        -   単一の共有データベースによって望ましくない範囲で単一のアーキテクチャ量子が形成されてしまっていないか
    -   データベース種別の最適化
        -   複数のデータベース種別を使用することでデータを最適化できないか？

## データ統合要因

-   どのような場合にデータをまとめることを検討すべきか？という問いに対する答えと根拠を提供する
-   データを統合することを推進する 2 つの主な理由

    -   データ関係
        -   テーブル間に密な関係を形成する外部キー，トリガー，ビューがあるか
    -   データトランザクション
        -   データの統合性と一貫性を確保するために単一のトランザクション単位が必要か？

-   DB をサービスごとに分散させるということはサービス間で外部キーやビューを利用できないということ

    -   削除する必要があること

-   この削除はコストが大きく，分散させることによるメリットより大きなコストがかかる可能性もある

## モノリシックなデータを分解する

-   データを分解する際に特に効果的な方法に 5 段階プロセスと呼ばれる手法がある

    -   このいてレーティブなプロセスでは，データドメインの概念を利用して，データを別のスキーマ，または，別の物理データベースに計画的に移行する

-   データドメインとは，特定のドメインに関連し，限られた範囲の機能で頻繁に使用される，結合されたデータベースアーティファクト(テーブル，ビュー，外部キー,トリガーなど，)の集合

-   データドメイン間の依存関係は取り除かなければいけない

## ステップ 1：データベースを分析し，データドメインを特定する

## ステップ 2：テーブルをデータドメインに割り当てる

## ステップ 3：データベースコネクションをデータドメインごとに分離する

## ステップ 4：スキーマを別個のデータベースサーバーに移動する

## ステップ 5：個別のデータベースサーバーへコネクション先を変更する
