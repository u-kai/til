# オブジェクト思考設計を実現する

## テストファーストは設計にどう役立すのか

- テストから先に書き始めると言うことは，まず何を実現したいのかを記述し，その後でどうやって実現するかを考えることのため，何をに集中することで対象となるオブジェクトの抽象度を正しいレベルに保てるようになる

  - オブジェクトの外部から見えるようにすべきなのは何かを決めなければいけないから情報隠蔽もしやすくなる

- またユニットテストをわかりやすく保つにはスコープを限定しなければいけない

  - 大きなテストからわかるのはテスト対象のコンポーネントがあまりに大きいのでより小さいコンポーネントに分割する必要があるということ

- 最後にユニットテストを構築するためには依存を注入することが多く，何に依存しているかを知っている必要がある
  - こうすることで，コンテキストの独立性がたかる
  - ユニットテストをできるようにするためにはその前に対象オブジェクトの環境を設定できるようになってなければいけないから

## オブジェクトはどこから来るのか

### 分解:巨大なオブジェクトを協力し合うオブジェクトのグループに分解する

### 発芽:オブジェクトが必要とする新しいサービスを定義し，そのサービスを提供するオブジェクトを新しく追加する

- 振る舞いをオブジェクトに追加しようとしたとき，自分たちの設計原則に従っておくと，新しいフィーチャーの中にはそのオブジェクトの内部に属さないものがあるときがある
- そう言う時には新しくインターフェイスをつくって，オブジェクトが必要とするサービスをそのオブジェクトの視点で定義する

  - その際はモックオブジェクトを利用して，あたかもすでにそのサービスが存在しているかのようにテストを書く
  - さのさい，テストで対象オブジェクトと，新しいコラボレータオとの関係を記述する

- 開発ライフサイクルでは，あるオブジェクトを実装する時に，そのオブジェクトが別のオブジェクトのオブジェクトによって提供されるサービスを必要としていることがあきらかになると,
  - 新しいサービスに名前をあたえ，クライアントのオブジェクトのユニットテストでモックする
  - そうすることで両者の関係が明らかになる
  - そして本物のオブジェクトを書いてそのサービスを提供するが，そこでもまた他のサービスが必要であることがわかる
  - このコラボレーションの連鎖をたどり，最終的には既存のオブジェクトと結びつける
  - この既存のオブジェクトは自分たちの書いたものであることもあれば，サードパーティ性の API であることもある
  - このようにして，入力から始め出力に向けて開発する
  - インターフェイスと実装をクライアントの必要性からプルして，具現化する
  - あるクラスが提供すべきと考えるフィーチャをプッシュするのではない
- 疑問

  - 良さそうに見えるけどモックだらけになる
    - モックの掃除はするのか？
  - 外側から始めるのは確かにうまく行きそうだが，必要なものをインターフェイスで繋いで行ったら，インターフェイスだらけのになってしまう？
  - 低凝集なことになってしまうきもする,どんだけしっかり設計してインターフェイスを作成するのか，それとも，他サービスが必要と思ったらすぐにインターフェイスを作成してテストを作成すべしなのか

### 包含:関連する複数のオブジェクトをそれを包含するオブジェクトにまとめる(隠蔽する)
