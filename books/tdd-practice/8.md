# サードパーティコードの上に構築する

## モックするのは自分の持っている型だけ

- 自分たちで変更できない型をモックしてはいけない
  - テストで外部ライブラリをモックすると特定の機能を実行する上で正しい状態にもっていくために複雑な処理をする必要がありりこうしたテストがややこしいと言うことは設計が良くない
  - また，外部ライブラリの実装をそのままモックかすることの難易度が高いことも多い

## アダプタ層を書く

- 外部ライブラリを使うときはアダプタ層を書く
  - アダプタ層は外部ライブラリのインターフェースを自分たちのコードに合わせるためのもの
- アダプタ層をドメイン言語にすることで，サードパーティ製のコードをドメイン言語で扱えるようになる
- このパターンに値型は当てはまらない
  - モックする必要がないから
  - それでも自分たちのコードの中でどのくらいサードパーティの値型を使うのかについては設計上の意思決定を行う必要がある
  - 基本的なものであれば間に何も置かないかもしれないが，大抵は，サードパーティサービスに対するのと同じように，分離の原則に従ってアプリケーションドメインと外部のドメインそれぞれに適した値型の間で変換を行うことになる
