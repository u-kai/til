# Batch Job

- ワークキュージョブでは、.spec.completions を未設定にし、.spec.parallelism を 1 より大きい数値に設定する必要があります
- ワークキュージョブは、少なくとも 1 つの Pod が正常に終了し、他のすべての Pod も終了したときに完了とみなされます
- このセットアップでは、Pod は自身と他の Pod との間で調整し、それぞれが作業している内容を把握して協調して完了する必要があります。
  - たとえば、キューに固定されたが不明な数の作業アイテムが格納されている場合、並行して動作する Pod はそれらを 1 つずつ取り出して作業することができます。
  - キューが空であることを最初に検出し、成功で終了する最初の Pod はジョブの完了を示します。ジョブコントローラは他のすべての Pod が終了するのを待機します。
- 1 つの Pod が複数の作業アイテムを処理するため、このジョブタイプは粒度の細かい作業アイテムに最適ですが、1 つの作業アイテムごとに 1 つの Pod のオーバーヘッドが正当化されない場合に適しています。

### Job Index

- なんか JOB_COMPLETION_INDEX ってのが Job を使うと使えるらしいので、これを使って並列に何か処理をすることができるよねってことかな

- JOB_COMPLETION_TOTAL ってのがあれば前 JOB 数がわかっていいんだけど、2023 現在ではサポートされてない

