# WPA(Wireless Protected Access)

- WEP の脆弱性対応に対する IEEE の標準化よりも先に WiFi Alliance が WPA という仕様を発表した
- WPA では暗号化方式，メッセージ認証方式および利用者認証方式が規定されている
- この動きと並行して IEEE も強固なセキュリティ規格である IEEE802.11i の標準化をしており，その最終盤のに準拠しているのが WPA2

## 利用者認証方式

- エンタープライズモードとパーソナルモードがある
- エンタープライズモードを使用することで，WEP が抱えていた同一の WEP キーを使用し続けるという問題を解消できる

## エンタープライズモード

- IEEE802.1X を使用して利用者認証を行う方式
- 暗号鍵が無線 LAN に接続するたびに動的に生成される
- 認証サーバと認証スイッチの役割を担う AP を設置する必要がある
- EAP-CHAP や EAP-TLS など

## パーソナルモード

- AP と端末が同じ事前共有鍵を設定しているときに限り認証に成功する
- これは旧来の WEP の WEP キーとそこまで変わらない
- このリスクを解消するにはより本格的な利用者認証方式であるエンタープライズモードを使用する必要がある

## 暗号化方式とメッセージ認証方式

- WPA と WPA2 で異なるアルゴリズムを採用している

### TKIP, Michael

- WPA は暗号化プロトコルとして TKIP(Temporal Key Integrity Protocol)を規定している
- フレームのメッセージ認証としては Michael
- TKIP は WEP の改良版

### AES-CCMP(Counter-mode with CBC-MAC Protocol)

- WPA は暗号化プロトコルとして AES をベースとした CCMP を規定している
- CCMP は暗号化だけでなく，フレームのメッセージ認証も伏せて行うことができる優れた技術
- CCMP はフレームの暗号化に CTR(カウンタ)モードを採用している
  - CTR モードでは，ブロックサイズと同じバイト数のカウンタ値を AES で暗号化し，暗号化したカウンタ値と平文ブロックを XOR 演算して暗号文ブロックを生成する
- CCMP はフレームのメッセージ認証に CBC モードを採用している
